% --------------------------------------------------------------
% Generated by bibere at {{ site.time | date: '%l:%M %P %Z on %b %-d, %Y' -}}.
% --------------------------------------------------------------

{%- assign minYear = include.minYear | plus: 0 -%}
<!-- Create a list of papers filtered by flags -->
{%- assign filtered = '' | split: '' -%}
{%- for p in site.data.bibere.papers -%}
    {%- assign numyear = p[1].year | to_integer -%}
    {%- if numyear >= minYear -%}
        {%- if include.filterAuthor %}
            {%- if p[1].authors contains include.filterAuthor -%}
                {%- assign filtered = filtered | push: p -%}
            {%- endif -%}
        {%- else -%}
            {%- assign filtered = filtered | push: p -%}
        {%- endif -%}
    {%- endif -%}
{%- endfor -%}
<!-- Group filtered ones by year, sorted -->
{% assign years = filtered | group_by_exp: "p", "p[1].year" | sort: "name" | reverse %}

{% capture newLine %}
{% endcapture %}

{%- for year in years -%}
    {%- assign numyear = year.name | strip | plus: 0 -%}
    {%- if numyear >= minYear -%}
        {%- for p in year.items -%}
            {%- assign pid = p[0] -%}
            {{ newLine }}
            {%- include bibere/bibtex.html pid=pid mainAuthor=include.mainAuthor -%}
            {{ newLine }}
        {%- endfor -%}
    {%- endif -%}
{%- endfor -%}
